<div class="manager-container">

  <section class="manager-header">
    <h1><i class="fas fa-cogs"></i> Store Management Dashboard</h1>
    <p>Manage your rental inventory and monitor business performance</p>
  </section>

  <!-- STATS -->
  <section class="dashboard-stats">
    <div class="stat-card">
      <div class="stat-icon items"><i class="fas fa-boxes"></i></div>
      <div class="stat-number">{{ totalItems$ }}</div>
      <div class="stat-label">Total Items</div>
    </div>

    <div class="stat-card">
      <div class="stat-icon rented"><i class="fas fa-handshake"></i></div>
      <div class="stat-number">{{ rentedCount$ }}</div>
      <div class="stat-label">Currently Rented</div>
    </div>

    <div class="stat-card">
      <div class="stat-icon available"><i class="fas fa-check-circle"></i></div>
      <div class="stat-number">{{ availableCount$ }}</div>
      <div class="stat-label">Available Items</div>
    </div>
  </section>

  <section class="manager-content">

    <!-- INVENTORY -->
    <article class="items-section">
      <div class="section-header">
        <h2><i class="fas fa-list"></i> Inventory Management</h2>

        <div class="search-filter">
          <input
            class="search-input"
            placeholder="Search items..."
            (input)="search = $any($event.target).value" />

          <select
            class="filter-select"
            (change)="stockFilter = $any($event.target).value">
            <option value="all">All Stock Levels</option>
            <option value="high">High Stock</option>
            <option value="medium">Medium Stock</option>
            <option value="low">Low Stock</option>
          </select>
        </div>
      </div>

      <table class="items-table">
        <thead>
        <tr>
          <th>Item Name</th>
          <th>Description</th>
          <th>Total Stock</th>
          <th>Available</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
        </thead>

        <tbody>
          @if (storeItems$ | async; as items) {
            @for (item of filteredItems$(items); track item.id) {
              <tr>
                <td class="item-name">{{ item.name }}</td>
                <td class="item-description">{{ item.description }}</td>
                <td>{{ item.stock }}</td>
                <td>{{ item.available }}</td>
                <td>
                  <span class="stock-badge"
                        [ngClass]="'stock-' + stockLevel(item)">
                    {{ stockLevel(item) | titlecase }} Stock
                  </span>
                </td>
                <td>
                  <div class="item-actions">
                    <button class="action-btn edit-btn"
                            (click)="editItem(item)">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn"
                            (click)="deleteItem(item)">
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>
            }
          } @else {
            <tr>
              <td colspan="6" class="empty-row">
                No items found in inventory.
              </td>
            </tr>
          }
        </tbody>
      </table>
    </article>

    <!-- SIDEBAR -->
    <aside>
      <article class="add-item-section">
        <div class="section-header">
          <h2>
            <i class="fas fa-plus-circle"></i>
            Add New Item
          </h2>
        </div>

        <form
          class="add-item-form"
          [formGroup]="addItemForm"
          (ngSubmit)="addItem()">

          <!-- NAME -->
          <div class="form-group">
            <label class="form-label">Item Name</label>
            <input
              class="form-input"
              placeholder="Enter item name"
              formControlName="name" />

            @if (itemName?.touched && itemName?.invalid) {
              <small class="error">Item name is required</small>
            }
          </div>

          <!-- DESCRIPTION -->
          <div class="form-group">
            <label class="form-label">Description</label>
            <textarea
              class="form-input form-textarea"
              placeholder="Enter key features, usage notes..."
              formControlName="description">
      </textarea>

            @if (itemDescription?.touched && itemDescription?.invalid) {
              <small class="error">Description is required</small>
            }
          </div>

          <!-- STOCK -->
          <div class="form-group">
            <label class="form-label">Stock Quantity</label>
            <input
              type="number"
              class="form-input"
              placeholder="Enter stock quantity"
              formControlName="stock" />

            @if (itemStock?.touched && itemStock?.invalid) {
              <small class="error">Stock must be at least 1</small>
            }
          </div>

          <!-- SUBMIT -->
          <button class="submit-btn" type="submit">
            <i class="fas fa-plus"></i>
            Add Item
          </button>
        </form>
      </article>

      <div class="quick-actions">
        <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
        <button (click)="exportData()">
          <i class="fas fa-download"></i> Export Inventory Data
        </button>
        <button (click)="generateReport()">
          <i class="fas fa-chart-bar"></i> Generate Monthly Report
        </button>
        <button (click)="bulkUpdate()">
          <i class="fas fa-edit"></i> Bulk Update Items
        </button>
      </div>
    </aside>

  </section>
</div>
