{% extends "base.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/registration.css') }}">
{% endblock %}

{% block content %}
<div class="register-container">
    <div class="register-card">
        <div class="register-header">
            <h2>Join RentalHub</h2>
            <p>Create your account to start renting</p>
        </div>

        <form class="register-form" action="" method="post">
            {{ form.hidden_tag() }}

            <div class="form-group">
                <label for="username">Username</label>
                <div class="input-wrapper">
                    {{ form.username(class="form-input", id="username", placeholder="Choose a unique username") }}
                    <i class="fas fa-user"></i>
                </div>
                {% for error in form.username.errors %}
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i> {{ error }}
                    </div>
                {% endfor %}
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <div class="input-wrapper">
                    {{ form.email(class="form-input", id="email", placeholder="Enter your email address") }}
                    <i class="fas fa-envelope"></i>
                </div>
                {% for error in form.email.errors %}
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i> {{ error }}
                    </div>
                {% endfor %}
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <div class="input-wrapper">
                    {{ form.password(class="form-input", id="password", placeholder="Create a strong password") }}
                    <i class="fas fa-lock"></i>
                </div>
                {% for error in form.password.errors %}
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i> {{ error }}
                    </div>
                {% endfor %}
                <div class="password-strength" id="passwordStrength"></div>
            </div>

            <div class="form-group">
                <label for="password2">Confirm Password</label>
                <div class="input-wrapper">
                    {{ form.password2(class="form-input", id="password2", placeholder="Confirm your password") }}
                    <i class="fas fa-lock"></i>
                </div>
                {% for error in form.password2.errors %}
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i> {{ error }}
                    </div>
                {% endfor %}
            </div>

            {{ form.submit(class="btn btn-primary register-btn", value="Create Account") }}

            <div class="terms-text">
                By creating an account, you agree to our
                <a href="#">Terms of Service</a> and
                <a href="#">Privacy Policy</a>.
            </div>
        </form>

        <div class="register-footer">
            <p>Already have an account?
                <a href="{{ url_for('user.login_view') }}" class="login-link">Sign in here</a>
            </p>
        </div>
    </div>
</div>

<script>
// Password strength indicator
document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const strengthDiv = document.getElementById('passwordStrength');

    if (password.length === 0) {
        strengthDiv.innerHTML = '';
        return;
    }

    let strength = 0;
    let feedback = [];

    if (password.length >= 8) strength++; else feedback.push('at least 8 characters');
    if (/[A-Z]/.test(password)) strength++; else feedback.push('uppercase letter');
    if (/[a-z]/.test(password)) strength++; else feedback.push('lowercase letter');
    if (/\d/.test(password)) strength++; else feedback.push('number');
    if (/[!@#$%^&*()_,.?":{}|<>]/.test(password)) strength++; else feedback.push('special character');

    let strengthText = '';
    let strengthClass = '';

    if (strength < 3) {
        strengthText = 'Weak password';
        strengthClass = 'strength-weak';
        if (feedback.length) {
            strengthText += ' – Add: ' + feedback.slice(0, 2).join(', ');
        }
    } else if (strength < 5) {
        strengthText = 'Medium password';
        strengthClass = 'strength-medium';
        if (feedback.length) {
            strengthText += ' – Add: ' + feedback.slice(0, 1).join(', ');
        }
    } else {
        strengthText = 'Strong password ✓';
        strengthClass = 'strength-strong';
    }

    strengthDiv.textContent = strengthText;
    strengthDiv.className = 'password-strength ' + strengthClass;
});
</script>
{% endblock %}
